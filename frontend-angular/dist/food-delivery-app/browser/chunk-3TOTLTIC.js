import{d as N,g as z,l as B,m as V,n as A,t as Y}from"./chunk-2J73YKV5.js";import{a as R}from"./chunk-A53UZT3J.js";import{a as j}from"./chunk-OU4M4I6I.js";import"./chunk-VW6JM3DE.js";import"./chunk-CFT3KPZ3.js";import{A as u,B as _,Ba as E,Ca as D,Fa as I,J as i,K as v,R as p,Ra as L,Sa as T,T as c,Ua as F,V as M,W as x,X as n,Y as t,Z as h,aa as C,ba as f,ca as g,fa as o,ga as P,ha as s,i as O,la as y,ma as S,na as w,pa as k,v as b}from"./chunk-DQHUU6N5.js";function W(r,l){if(r&1&&(n(0,"option",24),o(1),t()),r&2){let e=l.$implicit;c("value",e.value),i(),s(" ",e.label," ")}}function G(r,l){if(r&1){let e=C();n(0,"div",19)(1,"label",20),o(2,"Sort Orders By:"),t(),n(3,"select",21),w("ngModelChange",function(a){u(e);let m=g();return S(m.sortBy,a)||(m.sortBy=a),_(a)}),f("change",function(){u(e);let a=g();return _(a.onSortChange())}),p(4,W,2,2,"option",22),t(),n(5,"button",23),f("click",function(){u(e);let a=g();return _(a.loadNearbyOrders())}),o(6," \u{1F504} Refresh "),t()()}if(r&2){let e=g();i(3),y("ngModel",e.sortBy),i(),c("ngForOf",e.sortOptions),i(),c("disabled",e.loading)}}function H(r,l){if(r&1&&(n(0,"div",25),o(1),t()),r&2){let e=g();i(),s(" ",e.error," ")}}function $(r,l){r&1&&(n(0,"div",26),h(1,"div",27),n(2,"p"),o(3,"Loading nearby orders..."),t()())}function K(r,l){if(r&1&&(n(0,"div",36)(1,"span",37),o(2,"Surge:"),t(),n(3,"span",43),o(4),t()()),r&2){let e=g().$implicit;i(4),s("",e.surgeMultiplier,"x \u{1F525}")}}function U(r,l){if(r&1&&(n(0,"div",36)(1,"span",37),o(2,"Score:"),t(),n(3,"span",38),o(4),t()()),r&2){let e=g().$implicit;i(4),s("",e.optimalScore.toFixed(1),"/100")}}function q(r,l){if(r&1){let e=C();n(0,"div",31)(1,"div",32)(2,"span",33),o(3),t(),n(4,"span",34),o(5),t()(),n(6,"div",35)(7,"div",36)(8,"span",37),o(9,"Distance:"),t(),n(10,"span",38),o(11),t()(),n(12,"div",36)(13,"span",37),o(14,"Delivery Fee:"),t(),n(15,"span",38),o(16),t()(),n(17,"div",36)(18,"span",37),o(19,"Your Earning:"),t(),n(20,"span",39),o(21),t()(),p(22,K,5,1,"div",40),n(23,"div",36)(24,"span",37),o(25,"Est. Time:"),t(),n(26,"span",38),o(27),t()(),p(28,U,5,1,"div",40),t(),n(29,"div",41)(30,"button",42),f("click",function(){let a=u(e).$implicit,m=g(2);return _(m.acceptOrder(a.orderId))}),o(31," Accept Order "),t()()()}if(r&2){let e=l.$implicit,d=g(2);x(d.getPriorityClass(e.priority)),i(3),s("Order #",e.orderId,""),i(),x(d.getPriorityClass(e.priority)),i(),s(" ",e.priority," "),i(6),s("",d.getDistanceInKm(e.distance)," km"),i(5),s("\u20B9",e.deliveryFee,""),i(5),s("\u20B9",e.executiveEarning.toFixed(2),""),i(),c("ngIf",e.isSurgePricing),i(5),s("",e.estimatedDeliveryTime," min"),i(),c("ngIf",d.sortBy==="optimal")}}function J(r,l){r&1&&(n(0,"div",44)(1,"p"),o(2,"No orders available nearby"),t(),n(3,"p",45),o(4,"Try changing the sort option or wait for new orders"),t()())}function Q(r,l){if(r&1&&(n(0,"div",28),p(1,q,32,12,"div",29)(2,J,5,0,"div",30),t()),r&2){let e=g();i(),c("ngForOf",e.orders),i(),c("ngIf",e.orders.length===0)}}function X(r,l){r&1&&(n(0,"div",46)(1,"h3"),o(2,"You are currently offline"),t(),n(3,"p"),o(4,"Go online to start receiving delivery orders"),t()())}var se=(()=>{class r{constructor(e){this.deliveryService=e,this.orders=[],this.loading=!1,this.error="",this.isOnline=!1,this.sortBy="optimal",this.currentLocation={latitude:0,longitude:0},this.executiveId=0,this.sortOptions=[{value:"optimal",label:"Optimal (Recommended)"},{value:"commission",label:"Highest Commission"},{value:"distance",label:"Nearest First"},{value:"priority",label:"High Priority"}]}ngOnInit(){this.getCurrentLocation(),this.startLocationTracking()}ngOnDestroy(){this.locationSubscription&&this.locationSubscription.unsubscribe()}getCurrentLocation(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(e=>{this.currentLocation={latitude:e.coords.latitude,longitude:e.coords.longitude},this.isOnline&&this.loadNearbyOrders()},e=>{console.error("Error getting location:",e),this.error="Unable to get your location. Please enable location services."})}startLocationTracking(){this.locationSubscription=O(3e4).subscribe(()=>{this.isOnline&&(this.getCurrentLocation(),this.updateLocationOnServer())})}updateLocationOnServer(){this.currentLocation.latitude&&this.currentLocation.longitude&&this.deliveryService.updateLocation(this.executiveId,this.currentLocation.latitude,this.currentLocation.longitude).subscribe()}toggleOnlineStatus(){this.isOnline=!this.isOnline,this.deliveryService.updateStatus(this.executiveId,this.isOnline).subscribe({next:()=>{this.isOnline?this.loadNearbyOrders():this.orders=[]},error:e=>{this.error="Failed to update status",this.isOnline=!this.isOnline}})}loadNearbyOrders(){if(!this.currentLocation.latitude||!this.currentLocation.longitude){this.getCurrentLocation();return}this.loading=!0,this.error="",this.deliveryService.getNearbyOrders(this.executiveId,this.currentLocation.latitude,this.currentLocation.longitude,this.sortBy).subscribe({next:e=>{this.orders=e,this.loading=!1},error:e=>{this.error="Failed to load orders",this.loading=!1}})}onSortChange(){this.isOnline&&this.loadNearbyOrders()}acceptOrder(e){this.deliveryService.acceptOrder(this.executiveId,e).subscribe({next:()=>{this.loadNearbyOrders()},error:d=>{this.error="Failed to accept order"}})}getDistanceInKm(e){return(e/1e3).toFixed(1)}getPriorityClass(e){switch(e){case"HIGH":return"priority-high";case"MEDIUM":return"priority-medium";case"LOW":return"priority-low";default:return""}}static{this.\u0275fac=function(d){return new(d||r)(v(R))}}static{this.\u0275cmp=b({type:r,selectors:[["app-dashboard"]],standalone:!0,features:[k],decls:33,vars:9,consts:[[1,"dashboard-container"],[1,"dashboard-header"],[1,"header-content"],[1,"header-actions"],["routerLink","/delivery-executive/profile","title","Profile",1,"btn-icon"],[1,"dashboard-nav"],["routerLink","/delivery-executive/dashboard","routerLinkActive","active"],["routerLink","/delivery-executive/orders","routerLinkActive","active"],["routerLink","/delivery-executive/wallet","routerLinkActive","active"],["routerLink","/delivery-executive/profile","routerLinkActive","active"],[1,"dashboard-main"],[1,"status-card"],[1,"status-info"],[1,"btn-toggle",3,"click"],["class","sort-section",4,"ngIf"],["class","error-message",4,"ngIf"],["class","loading",4,"ngIf"],["class","orders-grid",4,"ngIf"],["class","offline-message",4,"ngIf"],[1,"sort-section"],["for","sortBy"],["id","sortBy",1,"sort-select",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"btn-refresh",3,"click","disabled"],[3,"value"],[1,"error-message"],[1,"loading"],[1,"spinner"],[1,"orders-grid"],["class","order-card",3,"class",4,"ngFor","ngForOf"],["class","no-orders",4,"ngIf"],[1,"order-card"],[1,"order-header"],[1,"order-id"],[1,"order-priority"],[1,"order-details"],[1,"detail-row"],[1,"label"],[1,"value"],[1,"value","earning"],["class","detail-row",4,"ngIf"],[1,"order-footer"],[1,"btn-accept",3,"click"],[1,"value","surge"],[1,"no-orders"],[1,"hint"],[1,"offline-message"]],template:function(d,a){d&1&&(h(0,"app-navbar"),n(1,"div",0)(2,"header",1)(3,"div",2)(4,"h1"),o(5,"Delivery Dashboard"),t(),n(6,"div",3)(7,"button",4)(8,"span"),o(9,"\u{1F464}"),t()()()()(),n(10,"nav",5)(11,"a",6),o(12,"Dashboard"),t(),n(13,"a",7),o(14,"My Orders"),t(),n(15,"a",8),o(16,"Wallet"),t(),n(17,"a",9),o(18,"Profile"),t()(),n(19,"main",10)(20,"div",11)(21,"div",12)(22,"h3"),o(23,"Status"),t(),n(24,"p"),o(25),t()(),n(26,"button",13),f("click",function(){return a.toggleOnlineStatus()}),o(27),t()(),p(28,G,7,3,"div",14)(29,H,2,1,"div",15)(30,$,4,0,"div",16)(31,Q,3,2,"div",17)(32,X,5,0,"div",18),t()()),d&2&&(i(25),P(a.isOnline?"You are online and receiving orders":"You are offline"),i(),M("active",a.isOnline),i(),s(" ",a.isOnline?"Go Offline":"Go Online"," "),i(),c("ngIf",a.isOnline),i(),c("ngIf",a.error),i(),c("ngIf",a.loading),i(),c("ngIf",!a.loading&&a.isOnline),i(),c("ngIf",!a.isOnline&&!a.loading))},dependencies:[I,E,D,F,L,T,Y,V,A,B,N,z,j],styles:[".dashboard-container[_ngcontent-%COMP%]{min-height:100vh;background:#f5f7fa}.dashboard-header[_ngcontent-%COMP%]{background:#fff;box-shadow:0 2px 8px #0000001a;padding:16px 24px}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;max-width:1200px;margin:0 auto}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#333;margin:0}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;border:none;background:#f0f0f0;cursor:pointer;transition:all .3s}.dashboard-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   .btn-icon[_ngcontent-%COMP%]:hover{background:#e0e0e0;transform:scale(1.1)}.dashboard-nav[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e0e0e0;padding:0 24px;display:flex;gap:32px;max-width:1200px;margin:0 auto}.dashboard-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{padding:16px 0;color:#666;text-decoration:none;border-bottom:3px solid transparent;transition:all .3s}.dashboard-nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#667eea}.dashboard-nav[_ngcontent-%COMP%]   a.active[_ngcontent-%COMP%]{color:#667eea;border-bottom-color:#667eea;font-weight:600}.dashboard-main[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:24px}.status-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:24px;margin-bottom:24px;display:flex;justify-content:space-between;align-items:center;box-shadow:0 2px 8px #0000001a}.status-card[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:18px;font-weight:600;margin:0 0 8px;color:#333}.status-card[_ngcontent-%COMP%]   .status-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#666;font-size:14px}.status-card[_ngcontent-%COMP%]   .btn-toggle[_ngcontent-%COMP%]{padding:12px 32px;border:2px solid #667eea;background:#fff;color:#667eea;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s}.status-card[_ngcontent-%COMP%]   .btn-toggle[_ngcontent-%COMP%]:hover{background:#f0f2ff}.status-card[_ngcontent-%COMP%]   .btn-toggle.active[_ngcontent-%COMP%]{background:#667eea;color:#fff}.status-card[_ngcontent-%COMP%]   .btn-toggle.active[_ngcontent-%COMP%]:hover{background:#5568d3}.sort-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;margin-bottom:24px;display:flex;align-items:center;gap:16px;box-shadow:0 2px 8px #0000001a}.sort-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333}.sort-section[_ngcontent-%COMP%]   .sort-select[_ngcontent-%COMP%]{flex:1;padding:10px 16px;border:2px solid #e0e0e0;border-radius:8px;font-size:14px;cursor:pointer}.sort-section[_ngcontent-%COMP%]   .sort-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea}.sort-section[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]{padding:10px 20px;background:#667eea;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;transition:all .3s}.sort-section[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]:hover:not(:disabled){background:#5568d3}.sort-section[_ngcontent-%COMP%]   .btn-refresh[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.error-message[_ngcontent-%COMP%]{background:#ffebee;color:#c62828;padding:16px;border-radius:8px;margin-bottom:24px;text-align:center}.loading[_ngcontent-%COMP%]{text-align:center;padding:60px 20px}.loading[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:50px;height:50px;border:4px solid #f0f0f0;border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite;margin:0 auto 16px}.loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:16px}.orders-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}.order-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:20px;box-shadow:0 2px 8px #0000001a;transition:all .3s;border-left:4px solid #e0e0e0}.order-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 6px 20px #00000026}.order-card.priority-high[_ngcontent-%COMP%]{border-left-color:#f44336}.order-card.priority-medium[_ngcontent-%COMP%]{border-left-color:#ff9800}.order-card.priority-low[_ngcontent-%COMP%]{border-left-color:#4caf50}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:1px solid #f0f0f0}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-id[_ngcontent-%COMP%]{font-weight:700;color:#333;font-size:16px}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-priority[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-priority.priority-high[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-priority.priority-medium[_ngcontent-%COMP%]{background:#fff3e0;color:#e65100}.order-card[_ngcontent-%COMP%]   .order-header[_ngcontent-%COMP%]   .order-priority.priority-low[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]{margin-bottom:16px}.order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0;font-size:14px}.order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666}.order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#333}.order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value.earning[_ngcontent-%COMP%]{color:#4caf50;font-size:16px}.order-card[_ngcontent-%COMP%]   .order-details[_ngcontent-%COMP%]   .detail-row[_ngcontent-%COMP%]   .value.surge[_ngcontent-%COMP%]{color:#ff5722}.order-card[_ngcontent-%COMP%]   .order-footer[_ngcontent-%COMP%]   .btn-accept[_ngcontent-%COMP%]{width:100%;padding:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .3s}.order-card[_ngcontent-%COMP%]   .order-footer[_ngcontent-%COMP%]   .btn-accept[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 4px 12px #667eea66}.no-orders[_ngcontent-%COMP%]{grid-column:1/-1;text-align:center;padding:60px 20px}.no-orders[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:16px;margin:8px 0}.no-orders[_ngcontent-%COMP%]   p.hint[_ngcontent-%COMP%]{font-size:14px;color:#999}.offline-message[_ngcontent-%COMP%]{text-align:center;padding:80px 20px}.offline-message[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:24px;color:#333;margin-bottom:12px}.offline-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:16px}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 768px){.orders-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.dashboard-nav[_ngcontent-%COMP%]{overflow-x:auto;gap:16px}.sort-section[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}"]})}}return r})();export{se as DashboardComponent};
