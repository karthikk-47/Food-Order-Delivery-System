import{a as N}from"./chunk-IJJXJBH4.js";import{b as V,d as T,g as D,t as L}from"./chunk-2J73YKV5.js";import{a as A}from"./chunk-OU4M4I6I.js";import{a as U}from"./chunk-VW6JM3DE.js";import"./chunk-CFT3KPZ3.js";import{A as p,B as m,Ca as w,Fa as k,J as a,K as P,R as b,Ra as I,T as c,Ua as F,X as n,Y as t,Z as E,a as _,aa as x,ba as f,ca as l,fa as i,ga as g,ha as v,la as C,ma as h,na as M,pa as y,v as S}from"./chunk-DQHUU6N5.js";function W(r,u){if(r&1){let e=x();n(0,"button",19),f("click",function(){p(e);let o=l(2);return m(o.toggleEdit())}),i(1,"\u270F\uFE0F Edit"),t()}}function z(r,u){if(r&1){let e=x();n(0,"button",20),f("click",function(){p(e);let o=l(2);return m(o.saveProfile())}),i(1,"\u{1F4BE} Save"),t()}}function B(r,u){if(r&1&&(n(0,"div",21)(1,"h4"),i(2,"Profile Details"),t(),n(3,"div",22)(4,"span",13),i(5,"Name:"),t(),n(6,"span",12),i(7),t()(),n(8,"div",22)(9,"span",13),i(10,"Email:"),t(),n(11,"span",12),i(12),t()(),n(13,"div",22)(14,"span",13),i(15,"Phone:"),t(),n(16,"span",12),i(17),t()(),n(18,"div",22)(19,"span",13),i(20,"Address:"),t(),n(21,"span",12),i(22),t()()()),r&2){let e=l(2);a(7),g((e.profile==null?null:e.profile.name)||"Not set"),a(5),g((e.profile==null?null:e.profile.email)||"Not set"),a(5),g((e.user==null?null:e.user.mobile)||"Not set"),a(5),g((e.profile==null?null:e.profile.address)||"Not set")}}function j(r,u){if(r&1){let e=x();n(0,"div",23)(1,"h4"),i(2,"Edit Profile"),t(),n(3,"div",24)(4,"label"),i(5,"Name"),t(),n(6,"input",25),M("ngModelChange",function(o){p(e);let d=l(2);return h(d.editForm.name,o)||(d.editForm.name=o),m(o)}),t()(),n(7,"div",24)(8,"label"),i(9,"Email"),t(),n(10,"input",26),M("ngModelChange",function(o){p(e);let d=l(2);return h(d.editForm.email,o)||(d.editForm.email=o),m(o)}),t()(),n(11,"div",24)(12,"label"),i(13,"Address"),t(),n(14,"textarea",27),M("ngModelChange",function(o){p(e);let d=l(2);return h(d.editForm.address,o)||(d.editForm.address=o),m(o)}),t()(),n(15,"div",24)(16,"button",28),f("click",function(){p(e);let o=l(2);return m(o.fillAddressFromLocation())}),i(17),t()(),n(18,"div",29)(19,"button",30),f("click",function(){p(e);let o=l(2);return m(o.cancelEdit())}),i(20,"Cancel"),t(),n(21,"button",31),f("click",function(){p(e);let o=l(2);return m(o.saveProfile())}),i(22,"Save Changes"),t()()()}if(r&2){let e=l(2);a(6),C("ngModel",e.editForm.name),a(4),C("ngModel",e.editForm.email),a(4),C("ngModel",e.editForm.address),a(2),c("disabled",e.locationLoading),a(),v(" ",e.locationLoading?"Detecting location...":"Use Current Location"," ")}}function q(r,u){if(r&1&&(n(0,"div",32),i(1),t()),r&2){let e=l(2);a(),g(e.successMessage)}}function G(r,u){if(r&1&&(n(0,"div",33),i(1),t()),r&2){let e=l(2);a(),g(e.errorMessage)}}function R(r,u){if(r&1){let e=x();n(0,"div",34)(1,"a",35)(2,"span",36),i(3,"\u{1F4CB}"),t(),n(4,"span"),i(5,"My Orders"),t()(),n(6,"a",37)(7,"span",36),i(8,"\u{1F37D}\uFE0F"),t(),n(9,"span"),i(10,"Browse Food"),t()(),n(11,"button",38),f("click",function(){p(e);let o=l(2);return m(o.logout())}),n(12,"span",36),i(13,"\u{1F6AA}"),t(),n(14,"span"),i(15,"Logout"),t()()()}}function Y(r,u){if(r&1&&(n(0,"div",3)(1,"div",4)(2,"div",5),i(3),t(),n(4,"div",6)(5,"h3"),i(6),t(),n(7,"p"),i(8),t(),n(9,"span",7),i(10,"Customer"),t()(),b(11,W,2,0,"button",8)(12,z,2,0,"button",9),t(),n(13,"div",10)(14,"div",11)(15,"span",12),i(16),t(),n(17,"span",13),i(18,"Total Orders"),t()(),n(19,"div",11)(20,"span",12),i(21),t(),n(22,"span",13),i(23,"Total Spent"),t()()(),b(24,B,23,4,"div",14)(25,j,23,5,"div",15)(26,q,2,1,"div",16)(27,G,2,1,"div",17)(28,R,16,0,"div",18),t()),r&2){let e=l();a(3),g(e.getInitial()),a(3),g((e.profile==null?null:e.profile.name)||(e.user==null?null:e.user.mobile)||"User"),a(2),v("\u{1F4F1} ",e.user==null?null:e.user.mobile,""),a(3),c("ngIf",!e.editing),a(),c("ngIf",e.editing),a(4),g(e.stats.totalOrders),a(5),v("\u20B9",e.stats.totalSpent,""),a(3),c("ngIf",!e.editing),a(),c("ngIf",e.editing),a(),c("ngIf",e.successMessage),a(),c("ngIf",e.errorMessage),a(),c("ngIf",!e.editing)}}function H(r,u){r&1&&(n(0,"div",39)(1,"p"),i(2,"Loading profile..."),t()())}var oe=(()=>{class r{constructor(e,s){this.userService=e,this.authService=s,this.profile=null,this.user=null,this.stats={totalOrders:0,totalSpent:0},this.loading=!1,this.editing=!1,this.editForm={name:"",email:"",address:""},this.successMessage="",this.errorMessage="",this.locationLoading=!1,this.user=this.authService.currentUserValue}ngOnInit(){this.loadProfile(),this.loadStats()}loadProfile(){this.user&&(this.loading=!0,this.userService.getUserProfile(this.user.id).subscribe({next:e=>{this.profile=e,this.editForm={name:e.name||"",email:e.email||"",address:e.address||""},this.loading=!1},error:()=>{this.loading=!1}}))}loadStats(){this.userService.getOrderStats().subscribe({next:e=>{this.stats=_(_({},this.stats),e)},error:()=>{}})}toggleEdit(){this.editing=!0,this.successMessage="",this.errorMessage=""}cancelEdit(){this.editing=!1,this.editForm={name:this.profile?.name||"",email:this.profile?.email||"",address:this.profile?.address||""}}saveProfile(){this.userService.updateUserProfile(this.user.id,this.editForm).subscribe({next:()=>{this.profile=_(_({},this.profile),this.editForm),this.editing=!1,this.successMessage="Profile updated successfully!",setTimeout(()=>this.successMessage="",3e3)},error:()=>{this.errorMessage="Failed to update profile. Please try again.",setTimeout(()=>this.errorMessage="",3e3)}})}fillAddressFromLocation(){if(this.errorMessage="",this.successMessage="",!navigator.geolocation){this.errorMessage="Geolocation is not supported by your browser.";return}this.locationLoading=!0,navigator.geolocation.getCurrentPosition(e=>{let s=e.coords.latitude,o=e.coords.longitude;this.userService.reverseGeocode(s,o).subscribe({next:d=>{let O=d?.results?.[0]?.formatted_address||d?.plus_code?.compound_code;O?(this.editForm.address=O,this.successMessage="Address fetched from your current location."):this.errorMessage="Could not determine address for your location.",this.locationLoading=!1},error:()=>{this.errorMessage="Failed to fetch address from location.",this.locationLoading=!1}})},()=>{this.errorMessage="Unable to get your location. Please check location permissions.",this.locationLoading=!1})}getInitial(){return this.profile?.name?this.profile.name.charAt(0).toUpperCase():this.user?.mobile?this.user.mobile.charAt(0):"U"}logout(){this.authService.logout()}static{this.\u0275fac=function(s){return new(s||r)(P(N),P(U))}}static{this.\u0275cmp=S({type:r,selectors:[["app-user-profile"]],standalone:!0,features:[y],decls:6,vars:2,consts:[[1,"profile-container"],["class","profile-card",4,"ngIf"],["class","loading",4,"ngIf"],[1,"profile-card"],[1,"profile-header"],[1,"avatar"],[1,"profile-info"],[1,"role-badge"],["class","edit-btn",3,"click",4,"ngIf"],["class","save-btn",3,"click",4,"ngIf"],[1,"profile-stats"],[1,"stat"],[1,"value"],[1,"label"],["class","profile-details",4,"ngIf"],["class","profile-edit",4,"ngIf"],["class","message success",4,"ngIf"],["class","message error",4,"ngIf"],["class","quick-actions",4,"ngIf"],[1,"edit-btn",3,"click"],[1,"save-btn",3,"click"],[1,"profile-details"],[1,"detail-row"],[1,"profile-edit"],[1,"form-group"],["type","text","placeholder","Enter your name",3,"ngModelChange","ngModel"],["type","email","placeholder","Enter your email",3,"ngModelChange","ngModel"],["placeholder","Enter your address","rows","3",3,"ngModelChange","ngModel"],["type","button",1,"btn-save",3,"click","disabled"],[1,"edit-actions"],[1,"btn-cancel",3,"click"],[1,"btn-save",3,"click"],[1,"message","success"],[1,"message","error"],[1,"quick-actions"],["routerLink","/user/orders",1,"action-btn"],[1,"icon"],["routerLink","/user/browse",1,"action-btn"],[1,"action-btn","logout",3,"click"],[1,"loading"]],template:function(s,o){s&1&&(E(0,"app-navbar"),n(1,"div",0)(2,"h2"),i(3,"My Profile"),t(),b(4,Y,29,12,"div",1)(5,H,3,0,"div",2),t()),s&2&&(a(4),c("ngIf",!o.loading),a(),c("ngIf",o.loading))},dependencies:[k,w,F,I,L,V,T,D,A],styles:[".profile-container[_ngcontent-%COMP%]{padding:24px;max-width:800px;margin:0 auto}h2[_ngcontent-%COMP%]{color:#333;margin-bottom:24px}.profile-card[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:32px;box-shadow:0 2px 8px #0000001a}.profile-header[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:32px;padding-bottom:24px;border-bottom:1px solid #f0f0f0}.avatar[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:linear-gradient(135deg,#071627,#1c3d5a);display:flex;align-items:center;justify-content:center;color:#fff;font-size:32px;font-weight:700}.profile-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center}.profile-info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:24px;color:#333}.profile-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#666}.role-badge[_ngcontent-%COMP%]{display:inline-block;padding:4px 12px;background:#e3f2fd;color:#1976d2;border-radius:12px;font-size:12px;font-weight:600}.profile-stats[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:24px;margin-bottom:32px}.stat[_ngcontent-%COMP%]{text-align:center;padding:20px;background:#f5f7fa;border-radius:8px}.stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{display:block;font-size:28px;font-weight:700;color:#333;margin-bottom:8px}.stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-size:14px}.profile-details[_ngcontent-%COMP%]{margin-bottom:32px}.profile-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 16px;color:#333}.detail-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:16px 0;border-bottom:1px solid #f0f0f0}.detail-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.detail-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666;font-weight:600}.detail-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{color:#333}.quick-actions[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}.action-btn[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:8px;padding:16px;background:#f5f7fa;border-radius:8px;text-decoration:none;color:#333;border:none;cursor:pointer;transition:all .2s}.action-btn[_ngcontent-%COMP%]:hover{background:#e8eaed;transform:translateY(-2px)}.action-btn[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]{font-size:24px}.action-btn.logout[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}.action-btn.logout[_ngcontent-%COMP%]:hover{background:#ffcdd2}.loading[_ngcontent-%COMP%]{text-align:center;padding:48px;color:#666}.edit-btn[_ngcontent-%COMP%], .save-btn[_ngcontent-%COMP%]{padding:8px 16px;border:none;border-radius:6px;cursor:pointer;font-weight:500}.edit-btn[_ngcontent-%COMP%]{background:#e3f2fd;color:#1976d2}.save-btn[_ngcontent-%COMP%]{background:#e8f5e9;color:#388e3c}.profile-edit[_ngcontent-%COMP%]{margin-bottom:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:600;color:#555}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:12px;border:1px solid #ddd;border-radius:8px;font-size:14px}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#1976d2}.edit-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:20px}.btn-cancel[_ngcontent-%COMP%]{padding:10px 20px;background:#f5f5f5;border:1px solid #ddd;border-radius:6px;cursor:pointer}.btn-save[_ngcontent-%COMP%]{padding:10px 20px;background:#1976d2;color:#fff;border:none;border-radius:6px;cursor:pointer}.btn-save[_ngcontent-%COMP%]:hover{background:#1565c0}.message[_ngcontent-%COMP%]{padding:12px;border-radius:6px;margin:16px 0}.message.success[_ngcontent-%COMP%]{background:#e8f5e9;color:#2e7d32}.message.error[_ngcontent-%COMP%]{background:#ffebee;color:#c62828}"]})}}return r})();export{oe as UserProfileComponent};
