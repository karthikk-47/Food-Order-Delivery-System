import{b as z,d as D,g as W,r as L,t as R}from"./chunk-2J73YKV5.js";import{a as V}from"./chunk-VW6JM3DE.js";import"./chunk-CFT3KPZ3.js";import{A as p,B as m,Ca as k,Fa as S,J as s,K as v,Oa as E,Qa as F,R as u,T as c,U as y,Ua as I,V as x,X as i,Y as o,Z as b,aa as P,ba as _,ca as a,fa as r,ga as M,ha as f,la as w,ma as C,na as h,pa as T,v as O}from"./chunk-DQHUU6N5.js";function B(n,g){if(n&1&&(i(0,"div",16)(1,"span"),r(2,"\u274C"),o(),r(3),o()),n&2){let e=a(2);s(3),f(" ",e.error," ")}}function N(n,g){n&1&&b(0,"span",17)}function j(n,g){if(n&1){let e=P();i(0,"div",6)(1,"p",7),r(2,"Enter your registered mobile number to receive an OTP"),o(),i(3,"div",8)(4,"label",9),r(5,"Mobile Number"),o(),i(6,"input",10),h("ngModelChange",function(t){p(e);let d=a();return C(d.mobile,t)||(d.mobile=t),m(t)}),_("keyup.enter",function(){p(e);let t=a();return m(t.requestOTP())}),o()(),u(7,B,4,1,"div",11),i(8,"button",12),_("click",function(){p(e);let t=a();return m(t.requestOTP())}),u(9,N,1,0,"span",13),r(10),o(),i(11,"div",14)(12,"a",15),_("click",function(){p(e);let t=a();return m(t.goToLogin())}),r(13,"\u2190 Back to Login"),o()()()}if(n&2){let e=a();s(6),x("error",e.error),w("ngModel",e.mobile),s(),c("ngIf",e.error),s(),c("disabled",e.loading),s(),c("ngIf",e.loading),s(),f(" ",e.loading?"Sending...":"Send OTP"," ")}}function q(n,g){if(n&1&&(i(0,"div",23)(1,"span",24),r(2,"\u{1F527} Dev Mode OTP:"),o(),i(3,"span",25),r(4),o()()),n&2){let e=a(2);s(4),M(e.devOtp)}}function A(n,g){if(n&1&&(i(0,"div",16)(1,"span"),r(2,"\u274C"),o(),r(3),o()),n&2){let e=a(2);s(3),f(" ",e.error," ")}}function Y(n,g){if(n&1&&(i(0,"div",26)(1,"span"),r(2,"\u2705"),o(),r(3),o()),n&2){let e=a(2);s(3),f(" ",e.success," ")}}function G(n,g){n&1&&b(0,"span",17)}function H(n,g){if(n&1){let e=P();i(0,"div",6)(1,"p",7),r(2),o(),u(3,q,5,1,"div",18),i(4,"div",8)(5,"label",19),r(6,"OTP"),o(),i(7,"input",20),h("ngModelChange",function(t){p(e);let d=a();return C(d.otp,t)||(d.otp=t),m(t)}),_("keyup.enter",function(){p(e);let t=a();return m(t.verifyOTP())}),o()(),u(8,A,4,1,"div",11)(9,Y,4,1,"div",21),i(10,"button",12),_("click",function(){p(e);let t=a();return m(t.verifyOTP())}),u(11,G,1,0,"span",13),r(12),o(),i(13,"div",22)(14,"span"),r(15,"Didn't receive OTP?"),o(),i(16,"a",15),_("click",function(){p(e);let t=a();return m(t.resendOTP())}),r(17,"Resend OTP"),o()(),i(18,"div",14)(19,"a",15),_("click",function(){p(e);let t=a();return m(t.step="mobile")}),r(20,"\u2190 Change Mobile Number"),o()()()}if(n&2){let e=a();s(2),f("Enter the OTP sent to ",e.mobile,""),s(),c("ngIf",e.devOtp),s(4),x("error",e.error),w("ngModel",e.otp),s(),c("ngIf",e.error),s(),c("ngIf",e.success),s(),c("disabled",e.loading),s(),c("ngIf",e.loading),s(),f(" ",e.loading?"Verifying...":"Verify OTP"," ")}}function U(n,g){if(n&1&&(i(0,"div",16)(1,"span"),r(2,"\u274C"),o(),r(3),o()),n&2){let e=a(2);s(3),f(" ",e.error," ")}}function J(n,g){n&1&&b(0,"span",17)}function K(n,g){if(n&1){let e=P();i(0,"div",6)(1,"p",7),r(2,"Create your new password"),o(),i(3,"div",8)(4,"label",27),r(5,"New Password"),o(),i(6,"input",28),h("ngModelChange",function(t){p(e);let d=a();return C(d.newPassword,t)||(d.newPassword=t),m(t)}),o()(),i(7,"div",8)(8,"label",29),r(9,"Confirm Password"),o(),i(10,"input",30),h("ngModelChange",function(t){p(e);let d=a();return C(d.confirmPassword,t)||(d.confirmPassword=t),m(t)}),_("keyup.enter",function(){p(e);let t=a();return m(t.resetPassword())}),o()(),u(11,U,4,1,"div",11),i(12,"button",12),_("click",function(){p(e);let t=a();return m(t.resetPassword())}),u(13,J,1,0,"span",13),r(14),o()()}if(n&2){let e=a();s(6),x("error",e.error),w("ngModel",e.newPassword),s(4),x("error",e.error),w("ngModel",e.confirmPassword),s(),c("ngIf",e.error),s(),c("disabled",e.loading),s(),c("ngIf",e.loading),s(),f(" ",e.loading?"Resetting...":"Reset Password"," ")}}function Q(n,g){if(n&1){let e=P();i(0,"div",31)(1,"div",32),r(2,"\u2705"),o(),i(3,"h3"),r(4,"Password Reset Successful!"),o(),i(5,"p"),r(6),o(),i(7,"button",33),_("click",function(){p(e);let t=a();return m(t.goToLogin())}),r(8," Go to Login "),o()()}if(n&2){let e=a();s(6),M(e.success)}}var re=(()=>{class n{constructor(e,l,t){this.authService=e,this.router=l,this.route=t,this.step="mobile",this.mobile="",this.otp="",this.newPassword="",this.confirmPassword="",this.loading=!1,this.error="",this.success="",this.devOtp="",this.role="USER",this.roleColor="#071627",this.route.data.subscribe(d=>{d.role&&(this.role=d.role,this.roleColor=d.color||"#071627")})}requestOTP(){if(!this.mobile){this.error="Please enter your mobile number";return}this.loading=!0,this.error="",this.authService.forgotPassword(this.mobile).subscribe({next:e=>{this.loading=!1,e.success?(this.step="otp",this.success=e.message,e.otp&&(this.devOtp=e.otp)):this.error=e.message||"Failed to send OTP"},error:e=>{this.loading=!1,this.error=e.error?.message||"Failed to send OTP. Please try again."}})}verifyOTP(){if(!this.otp){this.error="Please enter the OTP";return}this.loading=!0,this.error="",this.authService.verifyOTP(this.mobile,this.otp).subscribe({next:e=>{this.loading=!1,e.success?(this.step="password",this.success="OTP verified. Please set your new password."):this.error=e.message||"Invalid OTP"},error:e=>{this.loading=!1,this.error=e.error?.message||"Invalid OTP. Please try again."}})}resetPassword(){if(!this.newPassword||!this.confirmPassword){this.error="Please fill in all fields";return}if(this.newPassword!==this.confirmPassword){this.error="Passwords do not match";return}if(this.newPassword.length<6){this.error="Password must be at least 6 characters";return}this.loading=!0,this.error="",this.authService.resetPassword(this.mobile,this.otp,this.newPassword).subscribe({next:e=>{this.loading=!1,e.success?(this.step="success",this.success=e.message):this.error=e.message||"Failed to reset password"},error:e=>{this.loading=!1,this.error=e.error?.message||"Failed to reset password. Please try again."}})}goToLogin(){let e=this.role.toLowerCase();this.router.navigate(["/login",e==="deliveryexecutive"?"executive":e])}resendOTP(){this.otp="",this.devOtp="",this.requestOTP()}static{this.\u0275fac=function(l){return new(l||n)(v(V),v(F),v(E))}}static{this.\u0275cmp=O({type:n,selectors:[["app-forgot-password"]],standalone:!0,features:[T],decls:13,vars:6,consts:[[1,"forgot-password-container"],[1,"forgot-password-card"],[1,"logo"],[1,"logo-icon"],["class","step-content",4,"ngIf"],["class","step-content success-step",4,"ngIf"],[1,"step-content"],[1,"subtitle"],[1,"form-group"],["for","mobile"],["type","tel","id","mobile","placeholder","Enter your mobile number",3,"ngModelChange","keyup.enter","ngModel"],["class","alert alert-error",4,"ngIf"],[1,"btn-primary",3,"click","disabled"],["class","spinner",4,"ngIf"],[1,"back-link"],[3,"click"],[1,"alert","alert-error"],[1,"spinner"],["class","dev-otp",4,"ngIf"],["for","otp"],["type","text","id","otp","placeholder","Enter 6-digit OTP","maxlength","6",3,"ngModelChange","keyup.enter","ngModel"],["class","alert alert-success",4,"ngIf"],[1,"resend-link"],[1,"dev-otp"],[1,"dev-label"],[1,"otp-value"],[1,"alert","alert-success"],["for","newPassword"],["type","password","id","newPassword","placeholder","Enter new password",3,"ngModelChange","ngModel"],["for","confirmPassword"],["type","password","id","confirmPassword","placeholder","Confirm new password",3,"ngModelChange","keyup.enter","ngModel"],[1,"step-content","success-step"],[1,"success-icon"],[1,"btn-primary",3,"click"]],template:function(l,t){l&1&&(i(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),r(4,"\u{1F37D}\uFE0F"),o(),i(5,"h1"),r(6,"HomeBites"),o()(),i(7,"h2"),r(8,"Reset Password"),o(),u(9,j,14,7,"div",4)(10,H,21,10,"div",4)(11,K,15,10,"div",4)(12,Q,9,1,"div",5),o()()),l&2&&(y("--theme-color",t.roleColor),s(9),c("ngIf",t.step==="mobile"),s(),c("ngIf",t.step==="otp"),s(),c("ngIf",t.step==="password"),s(),c("ngIf",t.step==="success"))},dependencies:[S,k,R,z,D,L,W,I],styles:[".forgot-password-container[_ngcontent-%COMP%]{min-height:100vh;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#f5f7fa,#e4e8ec);padding:2rem}.forgot-password-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:2.5rem;width:100%;max-width:420px;box-shadow:0 10px 40px #0000001a}.forgot-password-card[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{text-align:center;margin-bottom:1.5rem}.forgot-password-card[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   .logo-icon[_ngcontent-%COMP%]{font-size:3rem;display:block;margin-bottom:.5rem}.forgot-password-card[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem;color:var(--theme-color, #071627);margin:0;font-weight:700}.forgot-password-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{text-align:center;color:#2c3e50;margin:0 0 1.5rem;font-size:1.5rem}.forgot-password-card[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{text-align:center;color:#7f8c8d;margin-bottom:1.5rem;font-size:.95rem}.step-content[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_fadeIn .3s ease}.form-group[_ngcontent-%COMP%]{margin-bottom:1.25rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#2c3e50;font-weight:600;font-size:.9rem}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.875rem 1rem;border:2px solid #e0e0e0;border-radius:8px;font-size:1rem;transition:all .3s ease;box-sizing:border-box}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--theme-color, #071627);box-shadow:0 0 0 3px #0716271a}.form-group[_ngcontent-%COMP%]   input.error[_ngcontent-%COMP%]{border-color:#e74c3c}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#bdc3c7}.alert[_ngcontent-%COMP%]{padding:.875rem 1rem;border-radius:8px;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem;font-size:.9rem}.alert.alert-error[_ngcontent-%COMP%]{background:#fef2f2;color:#dc2626;border:1px solid #fecaca}.alert.alert-success[_ngcontent-%COMP%]{background:#f0fdf4;color:#16a34a;border:1px solid #bbf7d0}.btn-primary[_ngcontent-%COMP%]{width:100%;padding:1rem;background:var(--theme-color, #071627);color:#fff;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;justify-content:center;gap:.5rem}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 12px #0003}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.7;cursor:not-allowed}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}.back-link[_ngcontent-%COMP%], .resend-link[_ngcontent-%COMP%]{text-align:center;margin-top:1.25rem}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .resend-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--theme-color, #071627);text-decoration:none;font-weight:600;cursor:pointer}.back-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .resend-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.back-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%], .resend-link[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#7f8c8d;margin-right:.5rem}.dev-otp[_ngcontent-%COMP%]{background:#fef3c7;border:1px solid #f59e0b;border-radius:8px;padding:.75rem 1rem;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}.dev-otp[_ngcontent-%COMP%]   .dev-label[_ngcontent-%COMP%]{font-size:.85rem;color:#92400e}.dev-otp[_ngcontent-%COMP%]   .otp-value[_ngcontent-%COMP%]{font-weight:700;font-size:1.2rem;color:#b45309;letter-spacing:2px}.success-step[_ngcontent-%COMP%]{text-align:center}.success-step[_ngcontent-%COMP%]   .success-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:1rem}.success-step[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#16a34a;margin:0 0 .5rem}.success-step[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#7f8c8d;margin-bottom:1.5rem}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}"]})}}return n})();export{re as ForgotPasswordComponent};
