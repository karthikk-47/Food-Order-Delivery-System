import{b as O,d as A,g as V,i as T,o as F,p as B,t as k}from"./chunk-2J73YKV5.js";import{a as N}from"./chunk-FQ3DSHQO.js";import{a as z}from"./chunk-OU4M4I6I.js";import{a as E}from"./chunk-VW6JM3DE.js";import"./chunk-CFT3KPZ3.js";import{A as p,B as u,Ca as S,Fa as I,J as o,K as w,R as h,T as d,Ua as P,X as i,Y as n,Z as _,aa as v,ba as b,ca as s,fa as a,ga as x,ha as c,la as C,ma as M,na as y,pa as W,v as f}from"./chunk-DQHUU6N5.js";function D(e,m){if(e&1&&(i(0,"div",4)(1,"div",5)(2,"h3"),a(3,"Current Balance"),n(),i(4,"p",6),a(5),n(),i(6,"p",7),a(7,"Available to withdraw"),n()(),i(8,"div",8)(9,"div",9)(10,"span",10),a(11,"Total Earnings"),n(),i(12,"span",11),a(13),n()(),i(14,"div",9)(15,"span",10),a(16,"Pending Amount"),n(),i(17,"span",11),a(18),n()()()()),e&2){let t=s();o(5),c("\u20B9",t.wallet.balance.toFixed(2),""),o(8),c("\u20B9",t.wallet.totalEarnings.toFixed(2),""),o(5),c("\u20B9",t.wallet.pendingAmount.toFixed(2),"")}}function j(e,m){if(e&1&&(i(0,"p",21),a(1),n()),e&2){let t=s(2);o(),x(t.error)}}function q(e,m){if(e&1&&(i(0,"p",22),a(1),n()),e&2){let t=s(2);o(),x(t.success)}}function L(e,m){if(e&1){let t=v();i(0,"div",12)(1,"h3"),a(2,"Request Withdrawal"),n(),i(3,"div",13)(4,"label",14),a(5,"Amount (\u20B9)"),n(),i(6,"input",15),y("ngModelChange",function(r){p(t);let g=s();return M(g.withdrawAmount,r)||(g.withdrawAmount=r),u(r)}),n(),i(7,"div",16)(8,"button",17),b("click",function(){p(t);let r=s();return u(r.withdraw())}),a(9),n()(),h(10,j,2,1,"p",18)(11,q,2,1,"p",19),i(12,"p",20),a(13),n()()()}if(e&2){let t=s();o(6),d("max",t.wallet.balance),C("ngModel",t.withdrawAmount),o(2),d("disabled",t.loading||!t.canWithdraw()),o(),c(" ",t.loading?"Processing...":"Withdraw"," "),o(),d("ngIf",t.error),o(),d("ngIf",t.success),o(2),c("Minimum withdrawal \u20B9",t.minWithdrawal,". Money will be settled to your registered account.")}}function R(e,m){e&1&&(i(0,"div",23),a(1,"Loading wallet..."),n())}var $=(()=>{class e{constructor(t,l){this.deliveryService=t,this.authService=l,this.wallet=null,this.loading=!1,this.executiveId=0,this.withdrawAmount=null,this.minWithdrawal=100,this.error="",this.success="";let r=this.authService.currentUserValue;r&&(this.executiveId=r.id)}ngOnInit(){this.loadWallet()}loadWallet(){this.loading=!0,this.deliveryService.getWallet(this.executiveId).subscribe({next:t=>{this.wallet=t,this.loading=!1},error:()=>this.loading=!1})}canWithdraw(){return!this.wallet||this.withdrawAmount==null?!1:this.withdrawAmount>=this.minWithdrawal&&this.withdrawAmount<=this.wallet.balance}withdraw(){if(!this.canWithdraw()){this.error=`Enter an amount between \u20B9${this.minWithdrawal} and your available balance.`;return}this.loading=!0,this.error="",this.success="",this.deliveryService.withdrawFromWallet(this.executiveId,this.withdrawAmount).subscribe({next:t=>{this.wallet=t,this.loading=!1,this.withdrawAmount=null,this.success="Withdrawal request processed. Amount will be settled shortly."},error:t=>{this.loading=!1,this.error=t?.error?.message||"Failed to process withdrawal. Please try again."}})}static{this.\u0275fac=function(l){return new(l||e)(w(N),w(E))}}static{this.\u0275cmp=f({type:e,selectors:[["app-wallet"]],standalone:!0,features:[W],decls:7,vars:3,consts:[[1,"wallet-container"],["class","wallet-summary",4,"ngIf"],["class","withdraw-section",4,"ngIf"],["class","loading",4,"ngIf"],[1,"wallet-summary"],[1,"balance-card"],[1,"amount"],[1,"hint"],[1,"stats-card"],[1,"stat"],[1,"label"],[1,"value"],[1,"withdraw-section"],[1,"withdraw-form"],["for","amount"],["id","amount","type","number","min","100","placeholder","Enter amount to withdraw",1,"amount-input",3,"ngModelChange","max","ngModel"],[1,"actions"],[1,"btn-withdraw",3,"click","disabled"],["class","error",4,"ngIf"],["class","success",4,"ngIf"],[1,"note"],[1,"error"],[1,"success"],[1,"loading"]],template:function(l,r){l&1&&(_(0,"app-navbar"),i(1,"div",0)(2,"h2"),a(3,"My Wallet"),n(),h(4,D,19,3,"div",1)(5,L,14,7,"div",2)(6,R,2,0,"div",3),n()),l&2&&(o(4),d("ngIf",r.wallet),o(),d("ngIf",r.wallet),o(),d("ngIf",r.loading&&!r.wallet))},dependencies:[I,S,P,k,O,T,A,B,F,V,z],styles:[".wallet-container[_ngcontent-%COMP%]{padding:24px;max-width:1200px;margin:0 auto}.wallet-summary[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:24px}.balance-card[_ngcontent-%COMP%], .stats-card[_ngcontent-%COMP%]{background:#fff;padding:24px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.amount[_ngcontent-%COMP%]{font-size:36px;font-weight:700;color:#4caf50;margin:8px 0}.stat[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:12px 0;border-bottom:1px solid #f0f0f0}.stat[_ngcontent-%COMP%]:last-child{border-bottom:none}.stat[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{color:#666}.stat[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#333}.hint[_ngcontent-%COMP%]{color:#666;margin-top:4px}.withdraw-section[_ngcontent-%COMP%]{margin-top:32px;max-width:480px}.withdraw-form[_ngcontent-%COMP%]{background:#fff;padding:20px;border-radius:12px;box-shadow:0 2px 8px #0000000f;display:flex;flex-direction:column;gap:12px}.amount-input[_ngcontent-%COMP%]{padding:10px 12px;border-radius:8px;border:1px solid #ddd;font-size:14px}.actions[_ngcontent-%COMP%]{margin-top:8px}.btn-withdraw[_ngcontent-%COMP%]{padding:10px 16px;border-radius:999px;border:none;background:#00c853;color:#fff;font-weight:600;cursor:pointer}.btn-withdraw[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:not-allowed}.error[_ngcontent-%COMP%]{color:#d32f2f;font-size:13px}.success[_ngcontent-%COMP%]{color:#2e7d32;font-size:13px}.note[_ngcontent-%COMP%]{font-size:12px;color:#777}"]})}}return e})();export{$ as WalletComponent};
