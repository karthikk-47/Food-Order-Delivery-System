<div class="forgot-password-container" [style.--theme-color]="roleColor">
  <div class="forgot-password-card">
    <div class="logo">
      <span class="logo-icon">üçΩÔ∏è</span>
      <h1>HomeBites</h1>
    </div>

    <h2>Reset Password</h2>

    <!-- Step 1: Enter Mobile -->
    <div *ngIf="step === 'mobile'" class="step-content">
      <p class="subtitle">Enter your registered mobile number to receive an OTP</p>
      
      <div class="form-group">
        <label for="mobile">Mobile Number</label>
        <input 
          type="tel" 
          id="mobile" 
          [(ngModel)]="mobile" 
          placeholder="Enter your mobile number"
          [class.error]="error"
          (keyup.enter)="requestOTP()">
      </div>

      <div class="alert alert-error" *ngIf="error">
        <span>‚ùå</span> {{ error }}
      </div>

      <button class="btn-primary" (click)="requestOTP()" [disabled]="loading">
        <span *ngIf="loading" class="spinner"></span>
        {{ loading ? 'Sending...' : 'Send OTP' }}
      </button>

      <div class="back-link">
        <a (click)="goToLogin()">‚Üê Back to Login</a>
      </div>
    </div>

    <!-- Step 2: Enter OTP -->
    <div *ngIf="step === 'otp'" class="step-content">
      <p class="subtitle">Enter the OTP sent to {{ mobile }}</p>
      
      <!-- Dev OTP Display -->
      <div class="dev-otp" *ngIf="devOtp">
        <span class="dev-label">üîß Dev Mode OTP:</span>
        <span class="otp-value">{{ devOtp }}</span>
      </div>

      <div class="form-group">
        <label for="otp">OTP</label>
        <input 
          type="text" 
          id="otp" 
          [(ngModel)]="otp" 
          placeholder="Enter 6-digit OTP"
          maxlength="6"
          [class.error]="error"
          (keyup.enter)="verifyOTP()">
      </div>

      <div class="alert alert-error" *ngIf="error">
        <span>‚ùå</span> {{ error }}
      </div>

      <div class="alert alert-success" *ngIf="success">
        <span>‚úÖ</span> {{ success }}
      </div>

      <button class="btn-primary" (click)="verifyOTP()" [disabled]="loading">
        <span *ngIf="loading" class="spinner"></span>
        {{ loading ? 'Verifying...' : 'Verify OTP' }}
      </button>

      <div class="resend-link">
        <span>Didn't receive OTP?</span>
        <a (click)="resendOTP()">Resend OTP</a>
      </div>

      <div class="back-link">
        <a (click)="step = 'mobile'">‚Üê Change Mobile Number</a>
      </div>
    </div>

    <!-- Step 3: Set New Password -->
    <div *ngIf="step === 'password'" class="step-content">
      <p class="subtitle">Create your new password</p>
      
      <div class="form-group">
        <label for="newPassword">New Password</label>
        <input 
          type="password" 
          id="newPassword" 
          [(ngModel)]="newPassword" 
          placeholder="Enter new password"
          [class.error]="error">
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <input 
          type="password" 
          id="confirmPassword" 
          [(ngModel)]="confirmPassword" 
          placeholder="Confirm new password"
          [class.error]="error"
          (keyup.enter)="resetPassword()">
      </div>

      <div class="alert alert-error" *ngIf="error">
        <span>‚ùå</span> {{ error }}
      </div>

      <button class="btn-primary" (click)="resetPassword()" [disabled]="loading">
        <span *ngIf="loading" class="spinner"></span>
        {{ loading ? 'Resetting...' : 'Reset Password' }}
      </button>
    </div>

    <!-- Step 4: Success -->
    <div *ngIf="step === 'success'" class="step-content success-step">
      <div class="success-icon">‚úÖ</div>
      <h3>Password Reset Successful!</h3>
      <p>{{ success }}</p>
      
      <button class="btn-primary" (click)="goToLogin()">
        Go to Login
      </button>
    </div>
  </div>
</div>
